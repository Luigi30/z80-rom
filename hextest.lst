Sjasm Z80 Assembler v0.42c - www.xl2s.tk             [2020.02.10 - 14:06:06]

hextest.asm
Errors: 0

       1   00:0000                          OUTPUT  "out/hextest.bin"
       2   00:9000                      
       3   00:9000                          org $9000
       4   00:9000                      
       5   00:9000                          include "vdpbios.inc"
       1.  00:9000  (00:0098)           VDP_PORT_VRAM  = $98
       2.  00:9000  (00:0099)           VDP_PORT_REGS  = $99
       3.  00:9000                      
       4.  00:9000                      ; Command bits
       5.  00:9000  (00:0040)           VDP_VRAM_WRITE  = $40
       6.  00:9000  (00:0080)           VDP_REG_WRITE   = $80
       7.  00:9000                      
       8.  00:9000  (00:0004)           tmswait:        equ 4                   ; wait divisor
       9.  00:9000                      
      10.  00:9000                      ; Function table names.
      11.  00:9000  (00:0000)           VDP_Reset                   equ 0
      12.  00:9000  (00:0001)           VDP_GoTextMode              equ 1
      13.  00:9000  (00:0002)           VDP_GoGraphics1             equ 2
      14.  00:9000  (00:0003)           VDP_GoGraphics2             equ 3
      15.  00:9000  (00:0004)           VDP_SetVRAMAddress          equ 4
      16.  00:9000  (00:0005)           VDP_SetRegistersFromArray   equ 5
      17.  00:9000  (00:0006)           VDP_SetRegister             equ 6
      18.  00:9000  (00:0007)           VDP_VRAMBlockCopy           equ 7
      19.  00:9000  (00:0008)           VDP_StringOut               equ 8
      20.  00:9000  (00:0009)           VDP_SetTextPosition         equ 9
      21.  00:9000                      
      22.  00:9000                      MACRO	DoVDPBIOS	
      23.  00:9000                    < 		rst	$28
      24.  00:9000                    < ENDMACRO
       6   00:9000                          include "bios.inc"
       1.  00:9000                      ; Function code equates.
       2.  00:9000  (00:0000)           B_CONOUT        = 0
       3.  00:9000  (00:0001)           B_STROUT        = 1
       4.  00:9000  (00:0002)           B_CONIN         = 2
       5.  00:9000  (00:0003)           B_CONSTAT       = 3
       6.  00:9000  (00:0004)           B_STRIN         = 4
       7.  00:9000                      
       8.  00:9000                      ; Device IDs for BIOS functions
       9.  00:9000  (00:0001)           DEV_AUX			= 1 ; RS-232.
      10.  00:9000  (00:0002)           DEV_CON			= 2	; Console. Can be redirected.
      11.  00:9000  (00:0005)           DEV_SCREEN		= 5	; Screen.
      12.  00:9000                      
      13.  00:9000                      MACRO	DoBIOS	
      14.  00:9000                    < 		rst	$20
      15.  00:9000                    < ENDMACRO
       7   00:9000                      
       8   00:9000                      START:
       9   00:9000  11 2A 90                ld		de,HelloWorld
      10   00:9003  0E 01               	ld		c,B_STROUT
      11   00:9005                      	DoBIOS
      11   00:9005  E7                >   rst $20
      12   00:9006                      
      13   00:9006  F3                      di
      14   00:9007                      
      15   00:9007  0E 00                   ld      c,VDP_Reset
      16   00:9009                          DoVDPBIOS
      16   00:9009  EF                >   rst $28
      17   00:900A                      
      18   00:900A  21 00 00                ld      hl,0
      19   00:900D  0E 01                   ld      c,VDP_GoTextMode
      20   00:900F                          DoVDPBIOS
      20   00:900F  EF                >   rst $28
      21   00:9010                      
      22   00:9010  11 28 00                ld      de,40
      23   00:9013  0E 04                   ld      c,VDP_SetVRAMAddress
      24   00:9015                          DoVDPBIOS
      24   00:9015  EF                >   rst $28
      25   00:9016                      
      26   00:9016  21 41 90                ld      hl,BannerData
      27   00:9019  CD 1E 90                call    VDP_B_StringOut
      28   00:901C                      
      29   00:901C  FB                      ei
      30   00:901D                      
      31   00:901D  C9                      ret
      32   00:901E                      
      33   00:901E                          ; di
      34   00:901E                      
      35   00:901E                      
      36   00:901E                          ; ld      de,40
      37   00:901E                          ; call    VDP_SetVRAMAddress
      38   00:901E                      
      39   00:901E                          ; ld      a, 0                          ; put title at (1,0)
      40   00:901E                          ; ld      e, 1
      41   00:901E                          ; call    VDP_TextPosition
      42   00:901E                          ; ld      hl,BannerData                  ; output title
      43   00:901E                          ; call    VDP_StringOut
      44   00:901E                          ; ei
      45   00:901E                          ; ret
      46   00:901E                      
      47   00:901E                      ;;;;;;;;;;;;;;;;
      48   00:901E                      
      49   00:901E                      VDP_B_StringOut:
      50   00:901E  7E                      ld      a, (hl)                 ; get the current byte from ram
      51   00:901F  FE 00                   cp      0                       ; return when NULL is encountered
      52   00:9021  C8                      ret     z
      53   00:9022  D3 98                   out     (VDP_PORT_VRAM), a             ; send it to vram
      54   00:9024  00 (3)                  defs    14/tmswait, 0         ; nops to waste time
      55   00:9027  23                      inc     hl                      ; next byte
      56   00:9028  18 F4                   jr      VDP_B_StringOut
      57   00:902A                      
      58   00:902A                      HelloWorld:
      59   00:902A                      	db	    "TMS9918 ASCII Thingy",13,10,0
      59   00:902A  54 4D 53 39 39 31 38 20 41 53 43 49 49 20 54 68 
      59   00:903A  69 6E 67 79 0D 0A 00 
      60   00:9041                      
      61   00:9041                      BannerData:
      62   00:9041                          db      "****************************************"
      62   00:9041  2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 
      62   00:9051  2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 
      62   00:9061  2A 2A 2A 2A 2A 2A 2A 2A 
      63   00:9069                          db      "* P R O C Y O N / 8 0    M O N I T O R *"
      63   00:9069  2A 20 50 20 52 20 4F 20 43 20 59 20 4F 20 4E 20 
      63   00:9079  2F 20 38 20 30 20 20 20 20 4D 20 4F 20 4E 20 49 
      63   00:9089  20 54 20 4F 20 52 20 2A 
      64   00:9091                          db      "*                                      *"
      64   00:9091  2A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 
      64   00:90A1  20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 
      64   00:90B1  20 20 20 20 20 20 20 2A 
      65   00:90B9                          db      "*  Official Operating System of 1979!  *"
      65   00:90B9  2A 20 20 4F 66 66 69 63 69 61 6C 20 4F 70 65 72 
      65   00:90C9  61 74 69 6E 67 20 53 79 73 74 65 6D 20 6F 66 20 
      65   00:90D9  31 39 37 39 21 20 20 2A 
      66   00:90E1                          db      "*                                      *"
      66   00:90E1  2A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 
      66   00:90F1  20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 
      66   00:9101  20 20 20 20 20 20 20 2A 
      67   00:9109                          db      "*      VDP Routine Test Program 1      *"
      67   00:9109  2A 20 20 20 20 20 20 56 44 50 20 52 6F 75 74 69 
      67   00:9119  6E 65 20 54 65 73 74 20 50 72 6F 67 72 61 6D 20 
      67   00:9129  31 20 20 20 20 20 20 2A 
      68   00:9131                          db      "****************************************"
      68   00:9131  2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 
      68   00:9141  2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 2A 
      68   00:9151  2A 2A 2A 2A 2A 2A 2A 2A 
      69   00:9159  00                      db      0
      70   00:915A                      
      71   00:915A                      VDP_DefaultRegisters:
      72   00:915A                          ; Blanking, 16KB VRAM
      73   00:915A                          db      $00, $80, $00, $00, $00, $00, $00, $00
      73   00:915A  00 80 00 00 00 00 00 00 
      74   00:9162                      
      75   00:9162  00 (8)              VDP_ShadowRegs: ds 8   ; 8 bytes of shadow registers

    LABELS
-------------------------------------------------
00:00000098   VDP_PORT_VRAM
00:00000099 X VDP_PORT_REGS
00:00000040 X VDP_VRAM_WRITE
00:00000080 X VDP_REG_WRITE
00:00000004   tmswait
00:00000000   VDP_Reset
00:00000001   VDP_GoTextMode
00:00000002 X VDP_GoGraphics1
00:00000003 X VDP_GoGraphics2
00:00000004   VDP_SetVRAMAddress
00:00000005 X VDP_SetRegistersFromArray
00:00000006 X VDP_SetRegister
00:00000007 X VDP_VRAMBlockCopy
00:00000008 X VDP_StringOut
00:00000009 X VDP_SetTextPosition
00:00000000 X B_CONOUT
00:00000001   B_STROUT
00:00000002 X B_CONIN
00:00000003 X B_CONSTAT
00:00000004 X B_STRIN
00:00000001 X DEV_AUX
00:00000002 X DEV_CON
00:00000005 X DEV_SCREEN
00:00009000 X START
00:0000901E   VDP_B_StringOut
00:0000902A   HelloWorld
00:00009041   BannerData
00:0000915A X VDP_DefaultRegisters
00:00009162 X VDP_ShadowRegs


 Output: hextest.out
-------------------------------------------------

 Page: 00
  Org: 00009000  Size: *  Used: 00000000

    No output

 Output: out\hextest.bin
-------------------------------------------------

 Page: 00
  Org: 00009000  Size: *  Used: 0000016A

   Address   Length Align   Label
   00009000     362         START
